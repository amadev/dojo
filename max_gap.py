# name: |
#   Maximum Consecutive Gap
#   Given an unsorted array, find the maximum difference between the
#   successive elements in its sorted form.
#   requirements: time - O(n), space - O(n)
# input: array of unsorted integers
# output: number - maximum difference between numbers in sorted array
# idea: |
#   create n - 1 buckets, size of bucket: max - min / n - 1
#   for convinience buckets can be represented as list of dict with count, max, and min
#   next find buckets with gap and calculate diff as next_b[min] - prev_b[max]
#   and find maximum for similar diffs


import math

class Solution:
    # @param A : tuple of integers
    # @return an integer
    def maximumGap(self, A):
        n = len(A)
        if n < 2:
            return 0
        mx = max(A)
        mn = min(A)
        b = (mx - mn) / float(n - 1)
        if b == 0:
            return 0
        bs = [None]  * int(math.ceil(mx / b) + 1)
        for i in xrange(n):
            bid = int(math.ceil(A[i] / b))
            if bs[bid] is None:
                bs[bid] = {'cnt': 0,
                           'mn': float("inf"),
                           'mx': -float("inf")}
            bs[bid]['cnt'] += 1
            bs[bid]['mn'] = min(bs[bid]['mn'], A[i])
            bs[bid]['mx'] = max(bs[bid]['mx'], A[i])
        bs = filter(None, bs)
        if not bs:
            return 0
        prev = bs[0]
        m = 0
        for i in xrange(1, len(bs)):
            cur = bs[i]
            m = max(m, cur['mn'] - prev['mx'])
            prev = cur
        return m

s = Solution()
assert 3 == s.maximumGap([5, 3, 1, 8, 9, 2, 4])

assert 1 == s.maximumGap([ 1, 1, 2 ])
assert 0 == s.maximumGap([])
assert 0 == s.maximumGap([1, 1, 1])
assert 1 == s.maximumGap([1, 2])
assert 5 == s.maximumGap([1, 10, 5])
assert 12 == s.maximumGap( [ 1, 10, 21, 33, 45 ])
assert 2830792 == s.maximumGap([ 83564666, 2976674, 46591497, 24720696, 16376995, 63209921, 25486800, 49369261, 20465079, 64068560, 7453256, 14180682, 65396173, 45808477, 10172062, 28790225, 82942061, 88180229, 62446590, 77573854, 79342753, 2472968, 74250054, 17223599, 47790265, 24757250, 40512339, 24505824, 30067250, 82972321, 32482714, 76111054, 74399050, 65518880, 94248755, 76948016, 76621901, 46454881, 40376566, 13867770, 76060951, 71404732, 21608002, 26893621, 27370182, 35088766, 64827587, 67610608, 90182899, 66469061, 67277958, 92926221, 58156218, 44648845, 37817595, 46518269, 44972058, 27607545, 99404748, 39262620, 98825772, 89950732, 69937719, 78068362, 78924300, 91679939, 52530444, 71773429, 57678430, 75699274, 5835797, 74160501, 51193131, 47950620, 4572042, 85251576, 49493188, 77502342, 3244395, 51211050, 44229120, 2135351, 47258209, 77312779, 37416880, 59038338, 96069936, 20766025, 35497532, 67316276, 38312269, 38357645, 41600875, 58590177, 99257528, 99136750, 4796996, 84369137, 54237155, 64368327, 94789440, 40718847, 12226041, 80504660, 8177227, 85151842, 36165763, 72764013, 36326808, 80969323, 22947547, 76322099, 7536094, 18346503, 65759149, 45879388, 53114170, 92521723, 15492250, 42479923, 20668783, 64053151, 68778592, 3669297, 73903133, 28973293, 73195487, 64588362, 62227726, 17909010, 70683505, 86982984, 64191987, 71505285, 45949516, 28244755, 33863602, 18256044, 25110337, 23997763, 81020611, 10135495, 925679, 98158797, 73400633, 27282156, 45863518, 49288993, 52471826, 30553639, 76174500, 28828417, 41628693, 80019078, 64260962, 5577578, 50920883, 16864714, 54950300, 9267396, 56454292, 40872286, 33819401, 75369837, 6552946, 26963596, 22368984, 43723768, 39227673, 98188566, 1054037, 28292455, 18763814, 72776850, 47192134, 58393410, 14487674, 4852891, 44100801, 9755253, 37231060, 42836447, 38104756, 77865902, 67635663, 43494238, 76484257, 80555820, 8632145, 3925993, 81317956, 12645616, 23438120, 48241610, 20578077, 75133501, 46214776, 35621790, 15258257, 20145132, 32680983, 94521866, 43456056, 19341117, 29693292, 38935734, 62721977, 31340268, 91841822, 22303667, 96935307, 29160182, 61869130, 33436979, 32438444, 87945655, 43629909, 88918708, 85650550, 4201421, 11958347, 74203607, 37964292, 56174257, 20894491, 33858970, 45292153, 22249182, 77695201, 34240048, 36320401, 64890030, 81514017, 58983774, 88785054, 93832841, 12338671, 46297822, 26489779, 85959340 ])


assert 1307682 == s.maximumGap([ 57593914, 67146417, 899038, 91012308, 35487086, 95261065, 90668611, 14705525, 96497886, 74381445, 15126576, 49580079, 68715911, 9580932, 42994105, 77477202, 1020814, 53119806, 92132108, 18080730, 88993499, 74874841, 65182207, 18845383, 50728455, 11281988, 76268083, 37400563, 44189721, 44842491, 70132802, 51328916, 81230046, 89647315, 17745274, 10229136, 28641741, 18061432, 81445701, 35987294, 3925489, 84754783, 76544848, 56311243, 26728904, 26759609, 41443122, 46322309, 63233320, 18753793, 80538793, 98644246, 66222498, 81162824, 81526982, 29402882, 20770204, 2223274, 69099579, 49025443, 9557426, 43042630, 76243189, 69388169, 79199747, 56227039, 96094010, 13470188, 13911530, 12910693, 83619965, 80017187, 91870127, 18330201, 78488458, 30614207, 72461055, 27571441, 17795352, 11427857, 41931210, 35867627, 49938133, 21638860, 81246692, 10025435, 14049172, 89308273, 89243142, 58863760, 10796559, 82406936, 79382809, 16302958, 61467576, 43763530, 7507607, 39565494, 14566195, 98751512, 84460426, 20743332, 62493125, 98920975, 8956530, 13413747, 35230978, 82310492, 2421437, 4657826, 83050328, 47057074, 39434348, 48106754, 77721822, 10360438, 74667831, 36959495, 43534121, 46797838, 41699525, 94307612, 40967083, 45241690, 74117541, 25653700, 95066359, 33516562, 93805035, 4394431, 32208880, 54707466, 22923652, 84491100, 64982493, 64240901, 76809195, 75522735, 57527228, 88952329, 78044518, 25661839, 60559775, 97057831, 3839316, 9119351, 22767046, 81728595, 95619458, 43027578, 40057913, 24532850, 62613411, 94763951, 417669, 15768645, 83111128, 89227073, 9096476, 97698123, 36205569, 87278386, 29159974, 95471361, 16863212, 28330764, 74530732, 44497584, 44433037, 51194764, 53716630, 65230442, 21134184, 56879794, 34415193, 61200012, 16592144, 80741159, 11863736, 25298622, 90025753, 59516909, 37570590, 90072528, 37267490, 46718613, 18561794, 71018582, 69149760, 41423152, 14197230, 18327877, 68130233, 40607108, 53011072, 40824660, 17950953, 50428974, 72872115, 77012232, 97884433, 43849202, 16706952, 20851348, 18526835, 256357, 1700444, 78851779, 52515093, 10258461, 3337906, 46665537, 85904664, 95546391, 82778555, 87618534, 95179625, 69390178, 75253629, 75738205, 72056669, 51827059, 19465350, 42867855, 14984654, 59264319, 88633176, 69773965, 74713953, 83430706, 31206555, 70331257, 39278454, 93649053, 47082292, 54876430, 54451329, 99713410, 84493913, 90580763, 85727836, 84364819, 80289107, 95763516, 45427980, 44326947, 44325024, 41319700, 41132223, 12499399, 88262116, 11542151, 83174867, 94075822, 6039177, 44884514, 37326560, 70344635, 71143922, 68864291, 76224344, 35866566, 42638039, 1939505, 3158134, 55927492, 36270476, 1985445, 82293136, 17740567, 61955119, 97583079, 99150350, 28486063, 94559864, 29718662, 85633723, 8107055, 73559084, 5786379, 21152487, 96710269, 37027677, 55268325, 2090364, 49177480, 10338216, 14465654, 75371549, 1739154, 30826171, 41348131, 30879595, 74967964, 66023133, 79294338, 73343797, 14637018, 12888783, 18889306, 41458669, 11131449, 48147826, 12138435, 75898664, 36825701, 54249565, 68057064, 61850083, 50412137, 76609679, 61344126, 82835651, 67535405, 1055546, 82355461, 77144397, 58414964, 73235041, 66470527, 87030887, 79829841, 75211286, 6063624, 67672798, 99834137, 35992290, 75985706, 36838682, 80818076, 28422865, 82010014, 25575164, 38013720, 7215052, 17560903, 33798854, 51716229, 48348696, 23883190, 11272691, 3219716, 35055675, 58286086, 63062986, 15341457, 10090688, 61137407, 59503776, 88143016, 41893832, 16052425, 70917271, 54508228, 8531256, 76072616, 92648919, 14188619, 66581378, 80180309, 48266553, 51702633, 11443880, 39931014, 93730073, 25579120, 21295900, 42775225, 73423937, 18952484, 11688159, 47050162, 74258722, 88097207, 18090194, 85153034, 59710418, 74604660, 43032544, 89934099, 79854755, 22642127, 42981586, 29972282, 42725636, 39981614, 89659204, 29471252, 44060968, 26999045, 58769125, 95075582, 7456500, 55419613, 30891509, 50016030, 63065693, 37022896, 71403347, 8862440, 79526764, 96667840, 86825387, 62942855, 55690942, 62563342, 28063736, 68275453, 50629689, 31017427, 32119186, 18519165, 47531557, 80016032, 6045418, 86875088, 84984585, 48745901, 2751615, 74410444, 77322237, 40496995, 36542551, 88179520, 42133583, 67373876, 5020047, 17915601, 69550887, 15523168, 77537015, 18205460, 41357673, 94762700, 8093355, 26509496, 57951757, 85071002, 24971530, 67253404, 48035189, 34320069, 30238990, 57645519, 21188675, 8432696, 75455187, 61334795, 39292511, 9600653, 3146195, 51758008, 67322037, 42158818, 78215544, 13525371, 84116298, 98363954, 4827217, 95804195, 37516777, 73729882, 35926140, 53670523, 15500625, 81863126, 12709039, 96409903, 59928499, 25995756, 69338656, 56807022, 82634946, 80856920, 70741840, 17800393, 80733678, 74223014, 54365475, 65162076, 38519446, 17017346, 88170943, 38588742, 88696640, 72136078, 35459764, 36060211, 58142751, 69303334, 83454567, 2161717, 97412993, 38992953, 93711751, 28173399, 84202246, 83500788, 87394908, 36550870, 48301352, 7868183, 82505917, 66771586, 56848339, 864875, 84622813, 26313104, 67576973, 94802789, 15456554, 5439164, 63683588, 71282949, 25795479 ])
